### Reactor Pattern  

---

反应器模式



#### 经典服务设计

---

![1585880707672](.\img\1585880707672.png)

* 每个处理器都要开启一个新的线程来处理请求
* 当请求过多时，线程创建过多，线程间频繁切换造成资源浪费



#### 事件驱动设计

---

* 需要更少的资源
* 编程复杂度提升
* 更多的是异步操作



#### 单线程Reactor模式

---

![1585881322940](.\img\1585881322940.png)

* 与传统模式相比 可以用一个线程接收所有请求，减少线程创建和线程切换的资源消耗
* 缺点
  * 当处理数据时线程阻塞会使整个系统阻塞



#### 线程池Reactor模式

---

![1585883265656](.\img\1585883265656.png)

* 优化单线程模式的IO等阻塞操作对系统的影响
* Reactor只用接收响应，将后续操作放入线程池执行，执行结束后 Reactor 返回响应
* 相比于单线程模式解决了 IO等操作导致阻塞而影响 Reactor 接收请求的问题



#### 多Reactor 模式

----

![1585884382171](.\img\1585884382171.png)

* 这也是 Netty 使用的模型 含有多个Reactor
* mainReactor 接收连接请求 接收后注册到 subReactor进行后续业务处理
  * mainReactor 类比于 Netty 的 BossEventLoopGroup
  * subReactor 类比于 Netty 的 WorkerEventLoopGroup

